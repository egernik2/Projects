### Краткая выжимка по работе с `paramiko`:

1. **Основные компоненты `paramiko`:**
   - **`Transport`**: Низкоуровневое SSH-соединение.
   - **`Channel`**: Виртуальный канал для выполнения команд или передачи данных.
   - **`SSHClient`**: Высокоуровневый интерфейс для управления SSH-соединениями.
   - **`SFTPClient`**: Для передачи файлов через SFTP.
   - **`invoke_shell()`**: Для интерактивной работы с удалённой оболочкой.

2. **Чтение вывода команды:**
   - **`exec_command()`**: Для выполнения команды и чтения вывода через `stdout` и `stderr`.
     ```python
     stdin, stdout, stderr = ssh.exec_command('ls -l')
     output = stdout.read().decode()
     ```
   - **`channel.makefile('r').read()`**: Чтение данных из канала как из файла.
   - **`channel.recv()`**: Чтение данных из канала в реальном времени.

3. **Работа с бесконечными командами:**
   - Используйте **`invoke_shell()`** для интерактивного режима.
   - Читайте данные по мере поступления с помощью **`channel.recv()`**.
   - Для прерывания команды отправьте **`Ctrl+C`** (`\x03`) или закройте канал (`channel.close()`).

4. **Пример прерывания команды и запуска новой:**
   ```python
   channel = ssh.invoke_shell()
   channel.send('tail -f /var/log/syslog\n')
   while True:
       if channel.recv_ready():
           output = channel.recv(1024).decode()
           if "нужная_подстрока" in output:
               channel.send('\x03')  # Ctrl+C
               break
   channel.send('новая_команда\n')

5. Закрытие каналов:
    При использовании exec_command() каналы создаются и закрываются автоматически.
    Закрытие канала вручную (stdin.channel.close()) прерывает команду, но новый вызов exec_command() создаст новый канал.

6. Когда что использовать:
    exec_command(): Для выполнения одиночных команд.
    invoke_shell(): Для интерактивных команд (например, tail -f, top).
    SFTPClient: Для передачи файлов.